!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).CG={})}(this,function(t){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function e(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function a(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(t){var e,n,i;e=r,i=o[n=t],n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,h=t[Symbol.iterator]();!(i=(s=h.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==h.return||h.return()}finally{if(r)throw o}}return n}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var s=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};o(this,n),this.callback=t,this.options=e,this._playing=!1,this._step=-1}return h(n,[{key:"_setTimeout",value:function(){var t=this.options.frameDuration;this._requestId=t?window.setTimeout(this._anim.bind(this),t):window.requestAnimationFrame(this._anim.bind(this))}},{key:"_clearTimeout",value:function(){this.options.frameDuration?window.clearTimeout(this._requestId):window.cancelAnimationFrame(this._requestId)}},{key:"_anim",value:function(){var t=this.options,e=t.frameCount,n=t.recycle;if(e&&this._step>=e-1?this._step=0:this._step+=1,this.callback(this._step),!1===n&&e&&this._step===e-1)return this._playing=!1,void(this._step=-1);this._playing&&this._setTimeout()}},{key:"start",value:function(){this._playing||(this._setTimeout(),this._playing=!0)}},{key:"stop",value:function(){this._clearTimeout(),this._playing=!1,this._step=-1}},{key:"pause",value:function(){this._playing&&(this._clearTimeout(),this._playing=!1)}},{key:"reset",value:function(){this._clearTimeout(),this._playing=!1,this._step=-1,this.callback(this._step)}},{key:"setStep",value:function(t){var e=this.options.frameCount,n=Number.parseInt(t,10);!this._playing&&e&&-1<n&&n<e&&(this._step=n,this.callback(this._step))}},{key:"next",value:function(){var t=this.options.frameCount;this._playing||(t&&this._step>=t-1?this._step=0:this._step+=1,this.callback(this._step))}},{key:"prev",value:function(){var t=this.options.frameCount;this._playing||(this._step<=0?this._step=t?t-1:0:--this._step,this.callback(this._step))}}]),n}(),u=3,y="#ca562c",l=2,f="#3969AC",g={width:2,strokeColor:"#008080",fillColor:"#b4c8a8"},x=1e-10;function d(t,e,n){return t.x*e.y-t.y*e.x+e.x*n.y-e.y*n.x+n.x*t.y-n.y*t.x}function v(t,e,n){return 0<d(t,e,n)}function p(t,e,n){return 0<=d(t,e,n)}function w(t,e,n){return d(t,e,n)<0}function b(t,e,n){var i=d(t,e,n);if(0<i)return!0;if(i<0)return!1;if(t.distanceTo(e)<t.distanceTo(n))return!0;if(t.distanceTo(e)>t.distanceTo(n))return!1;throw new Error("toLeft: Input same point")}function m(t,e,n){return 0===d(t,e,n)&&(t.x!==e.x?t.x<=n.x&&n.x<=e.x||e.x<=n.x&&n.x<=t.x:t.y<=n.y&&n.y<=e.y||e.y<=n.y&&n.y<=t.y)}function k(t,e,n,i){return!(t.equal(n)||t.equal(i)||e.equal(n)||e.equal(i))&&(v(t,e,n)!==v(t,e,i)&&v(n,i,t)!==v(n,i,e))}function _(t){for(var e=0,n=1;n<t.length;n++)(t[n].y<t[e].y||t[n].y===t[e].y&&t[n].x<t[e])&&(e=n);return e}function E(t){var e=t.slice(),n=_(e),i=e[n];return e.splice(n,1),e.sort(function(t,e){return d(i,e,t)}),e.unshift(i),e}function z(t,e,n,i){var r=t.x-i.x,o=t.y-i.y,s=t.z-i.z,h=e.x-i.x,a=e.y-i.y,c=e.z-i.z,u=n.x-i.x,y=n.y-i.y,l=n.z-i.z,f=r*(a*l-c*y)-o*(h*l-c*u)+s*(h*y-a*u);return f<-.5?-1:.5<f?1:0}var P=Object.freeze({__proto__:null,PRECISION:x,pointComparator:function(t,e){return t.equal(e)?0:t.x<e.x||t.x===e.x&&t.y<e.y?-1:1},pointComparatorY:function(t,e){return t.equal(e)?0:t.y<e.y||t.y===e.y&&t.x<e.x?-1:1},area2:d,areaSign:function(t,e,n){var i=(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y);return i<-.5?-1:.5<i?1:0},collinear:function(t,e,n){return Math.abs(d(t,e,n))<x},left:v,leftOn:p,right:w,toLeft:b,between:m,inTriangle:function(t,e,n,i){var r=b(e,n,i);return b(t,e,i)===r&&r===b(n,t,i)},intersectProp:k,diagonalie:function(t,e,n){for(var i=t.length,r=0;r<i-1;r++)if(k(t[r],t[r+1],e,n))return!1;return!(!t[i-1].equal(t[0])&&k(t[i-1],t[0],e,n))},inCone:function(t,e,n,i){return p(e,n,t)?v(e,i,t)&&v(i,e,n):!(p(e,i,n)&&p(i,e,t))},LTL:_,leftSort:E,inCircumcircle:function(t,e,n,i){var r=Math.pow(i.x,2)+Math.pow(i.y,2),o=Math.pow(t.x,2)+Math.pow(t.y,2)-r,s=Math.pow(e.x,2)+Math.pow(e.y,2)-r,h=Math.pow(n.x,2)+Math.pow(n.y,2)-r;return 0<(t.x-i.x)*(e.y-i.y)*h+(e.x-i.x)*(n.y-i.y)*o+(n.x-i.x)*(t.y-i.y)*s-(t.x-i.x)*(n.y-i.y)*s-(e.x-i.x)*(t.y-i.y)*h-(n.x-i.x)*(e.y-i.y)*o},volumeSign:z}),C=function(){function i(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,i),this.x=t,this.y=e,this.z=n}return h(i,[{key:"distanceTo",value:function(t){if(!(t instanceof i))throw new TypeError("parameter is not Point");return Math.sqrt(Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2)+Math.pow(Math.abs(this.z-t.z),2))}},{key:"equal",value:function(t){if(!(t instanceof i))throw new TypeError("parameter is not Point");return Math.abs(this.x-t.x)<x&&Math.abs(this.y-t.y)<x&&Math.abs(this.z-t.z)<x}}]),i}(),T=function(){function s(t,e){if(o(this,s),t instanceof C&&e instanceof C)return this.begin=t,void(this.end=e);try{this.begin=new C(t.x,t.y),this.end=new C(e.x,e.y)}catch(t){throw new TypeError("Segment needs begin & end point")}}return h(s,[{key:"parallelInt",value:function(t){return 0!==d(this.begin,this.end,t.begin)?null:m(this.begin,this.end,t.begin)?t.begin:m(this.begin,this.end,t.end)?t.end:m(t.begin,t.end,this.begin)?this.begin:m(t.begin,t.end,this.end)?this.end:null}},{key:"intersect",value:function(t){if(!(t instanceof s))throw new TypeError("Not Segment");var e=this.begin.x*(t.end.y-t.begin.y)+this.end.x*(t.begin.y-t.end.y)+t.end.x*(this.end.y-this.begin.y)+t.begin.x*(this.begin.y-this.end.y);if(0==e)return this.ParallelInt(t);var n=(this.begin.x*(t.end.y-t.begin.y)+t.begin.x*(this.begin.y-t.end.y)+t.end.x*(t.begin.y-this.begin.y))/e,i=-(this.begin.x*(t.begin.y-this.end.y)+this.end.x*(this.begin.y-t.begin.y)+t.begin.x*(this.end.y-this.begin.y))/e;if(n<-x||1+x<n||i<-x||1+x<i)return null;var r=this.begin.x+n*(this.end.x-this.begin.x),o=this.begin.y+n*(this.end.y-this.begin.y);return new C(r,o)}},{key:"intersectProp",value:function(t){if(!(t instanceof s))throw new TypeError("Not Segment");return b(this.begin,this.end,t.begin)!==b(this.begin,this.end,t.end)&&b(t.begin,t.end,this.begin)!==b(t.begin,t.end,this.end)}}]),s}(),S=function(){function e(t){o(this,e),this.vertices=t.slice(),t[0].equal(t[t.length-1])||this.vertices.push(t[0])}return h(e,[{key:"area",value:function(){for(var t=this.vertices.length,e=0,n=0;n<t-1;n++)e+=(this.vertices[n].x+this.vertices[n+1].x)*(this.vertices[n+1].y-this.vertices[n].y);return e/2}}]),e}(),M=function(){function r(t,e,n,i){o(this,r),this.leftBottom=new C(t,e),this.rightTop=new C(n,i)}return h(r,[{key:"Intersect",value:function(t){return!(this.leftBottom.x>t.rightTop.x||this.rightTop.x<t.leftBottom.x)&&!(this.leftBottom.y>t.rightTop.y||this.rightTop.y<t.leftBottom.y)}}]),r}(),j=function(){function i(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,i),this.x=t,this.y=e,this.z=n}return h(i,[{key:"normalize",value:function(){var t=this.length;return new i(this.x/t,this.y/t,this.z/t)}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"rotateZ",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.x,r=this.y;return this.x=i*e-r*n,this.y=i*n+r*e,this}},{key:"copy",value:function(){return new i(this.x,this.y,this.z)}},{key:"length",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}}],[{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"cross",value:function(t,e){return new i(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}},{key:"cos",value:function(t,e){return this.dot(t.normalize(),e.normalize())}},{key:"projection",value:function(t,e){return t.copy().scale(e.length*this.cos(t,e))}}]),i}(),A=function(){function n(t,e){o(this,n);try{this.origin=new C(t.x,t.y),this.direction=new j(e.x,e.y)}catch(t){throw new TypeError("Line need origin and direction:",t)}}return h(n,[{key:"getPoint",value:function(t){return new C(this.origin.x+t*this.direction.x,this.origin.y+t*this.direction.y)}},{key:"intersect",value:function(t){var e=this.getPoint(1),n=t.getPoint(1),i=this.origin.x*(n.y-t.origin.y)+e.x*(t.origin.y-n.y)+n.x*(e.y-this.origin.y)+t.origin.x*(this.origin.y-e.y);if(0==i)throw new Error("Parallel: ".concat(JSON.stringify(this),", ").concat(JSON.stringify(t)));var r=(this.origin.x*(n.y-t.origin.y)+t.origin.x*(this.origin.y-n.y)+n.x*(t.origin.y-this.origin.y))/i,o=this.origin.x+r*(e.x-this.origin.x),s=this.origin.y+r*(e.y-this.origin.y);return new C(o,s)}},{key:"intersectSegProp",value:function(t){return this.right(t.begin)!==this.right(t.end)}},{key:"intersectSegment",value:function(t){var e=this.getPoint(1),n=this.origin.x*(t.end.y-t.begin.y)+e.x*(t.begin.y-t.end.y)+t.end.x*(e.y-this.origin.y)+t.begin.x*(this.origin.y-e.y);if(0==n)throw new Error("Parallel: ".concat(JSON.stringify(this),", ").concat(JSON.stringify(t)));var i=-(this.origin.x*(t.begin.y-e.y)+e.x*(this.origin.y-t.begin.y)+t.begin.x*(e.y-this.origin.y))/n;if(i<-x||1+x<i)throw new Error("Line not intersect segment: ".concat(JSON.stringify(this),", ").concat(JSON.stringify(t)));var r=t.begin.x+i*(t.end.x-t.begin.x),o=t.begin.y+i*(t.end.y-t.begin.y);return new C(r,o)}},{key:"intersectRay",value:function(t){var e=this.getPoint(1),n=t.getPoint(1),i=this.origin.x*(n.y-t.origin.y)+e.x*(t.origin.y-n.y)+n.x*(e.y-this.origin.y)+t.origin.x*(this.origin.y-e.y);if(0==i)throw new Error("Parallel: ".concat(JSON.stringify(this),", ").concat(JSON.stringify(seg)));var r=-(this.origin.x*(t.origin.y-e.y)+e.x*(this.origin.y-t.origin.y)+t.origin.x*(e.y-this.origin.y))/i;if(r<-x)return null;var o=t.origin.x+r*(n.x-t.origin.x),s=t.origin.y+r*(n.y-t.origin.y);return new C(o,s)}},{key:"rayIntersectSegment",value:function(t){var e=this.getPoint(1),n=this.origin.x*(t.end.y-t.begin.y)+e.x*(t.begin.y-t.end.y)+t.end.x*(e.y-this.origin.y)+t.begin.x*(this.origin.y-e.y);if(0==n)throw new Error("Parallel: ".concat(JSON.stringify(this),", ").concat(JSON.stringify(t)));var i=(this.origin.x*(t.end.y-t.begin.y)+t.begin.x*(this.origin.y-t.end.y)+t.end.x*(t.begin.y-this.origin.y))/n,r=-(this.origin.x*(t.begin.y-e.y)+e.x*(this.origin.y-t.begin.y)+t.begin.x*(e.y-this.origin.y))/n;if(i<-x||r<-x||1+x<r)return null;var o=t.begin.x+r*(t.end.x-t.begin.x),s=t.begin.y+r*(t.end.y-t.begin.y);return new C(o,s)}},{key:"right",value:function(t){return w(this.origin,this.getPoint(1),t)}},{key:"left",value:function(t){return v(this.origin,this.getPoint(1),t)}}],[{key:"bisect",value:function(t,e){if(t.equal(e))throw new Error("Input equal points");return new n(new C((t.x+e.x)/2,(t.y+e.y)/2),new j(e.x-t.x,e.y-t.y).normalize().rotateZ(-Math.PI/2))}}]),n}(),I=Object.freeze({__proto__:null,Util:P,Point:C,Segment:T,Polygon:S,Rectangle:M,Line:A,Vector:j}),F=function(){function i(t){o(this,i),this.canvas=t;var e=Math.max(window.devicePixelRatio||2,2),n=this.canvas.getBoundingClientRect();this.width=n.width,this.height=n.height,this.canvas.width=n.width*e,this.canvas.height=n.height*e,this.ctx=t.getContext("2d"),this.ctx.scale(e,e),this.ctx.lineJoin="round"}return h(i,[{key:"clearCanvas",value:function(){var t=this.ctx.canvas,e=t.width,n=t.height;this.ctx.clearRect(0,0,e,n)}},{key:"drawPoint",value:function(t,e,n){var i,r=1<arguments.length&&void 0!==e?e:u,o=2<arguments.length&&void 0!==n?n:y;t&&t instanceof C&&(i=this.height,this.ctx.save(),this.ctx.lineWidth=r,this.ctx.strokeStyle=o,this.ctx.beginPath(),this.ctx.arc(t.x,i-t.y,r/2,0,2*Math.PI),this.ctx.stroke(),this.ctx.restore())}},{key:"drawPoints",value:function(t,e,n){var i,r=this,o=1<arguments.length&&void 0!==e?e:u,s=2<arguments.length&&void 0!==n?n:y;Array.isArray(t)&&(i=this.height,this.ctx.save(),this.ctx.lineWidth=o,this.ctx.strokeStyle=s,this.ctx.beginPath(),t.forEach(function(t){r.ctx.moveTo(t.x,i-t.y),r.ctx.arc(t.x,i-t.y,o/2,0,2*Math.PI)}),this.ctx.stroke(),this.ctx.restore())}},{key:"drawSegment",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:l,r=2<arguments.length&&void 0!==n?n:f,o=this.height;this.ctx.save(),void 0!==i&&(this.ctx.lineWidth=i),void 0!==r&&(this.ctx.strokeStyle=r),this.ctx.beginPath(),this.ctx.moveTo(t.begin.x,o-t.begin.y),this.ctx.lineTo(t.end.x,o-t.end.y),this.ctx.stroke(),this.ctx.restore()}},{key:"drawSegments",value:function(t,e,n){var i=this,r=1<arguments.length&&void 0!==e?e:l,o=2<arguments.length&&void 0!==n?n:f;this.ctx.save(),void 0!==r&&(this.ctx.lineWidth=r),void 0!==o&&(this.ctx.strokeStyle=o);var s=this.height;this.ctx.beginPath(),t.forEach(function(t){i.ctx.moveTo(t.begin.x,s-t.begin.y),i.ctx.lineTo(t.end.x,s-t.end.y)}),this.ctx.stroke(),this.ctx.restore()}},{key:"drawPolygon",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:{style:{}},i=a({},g);Object.assign(i,n.style),this.ctx.save(),this.ctx.lineWidth=i.width,this.ctx.fillStyle=i.fillColor,this.ctx.strokeStyle=i.strokeColor;var r=t.vertices;if(r&&Array.isArray(r)&&!(r.length<1)){var o=this.height;this.ctx.beginPath(),this.ctx.moveTo(r[0].x,o-r[0].y);for(var s=1;s<r.length;s++)this.ctx.lineTo(r[s].x,o-r[s].y);this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()}}},{key:"drawPolygons",value:function(t,e){var n,i,r,o=this,s=1<arguments.length&&void 0!==e?e:{style:{}};t&&Array.isArray(t)&&(n=a({},g),Object.assign(n,s.style),this.ctx.save(),this.ctx.lineWidth=n.width,this.ctx.fillStyle=n.fillColor,this.ctx.strokeStyle=n.strokeColor,i=this.height,this.ctx.beginPath(),t.forEach(function(t){if((r=t.vertices?t.vertices:t)&&Array.isArray(r)&&1<r.length){o.ctx.moveTo(r[0].x,i-r[0].y);for(var e=1;e<r.length;e++)o.ctx.lineTo(r[e].x,i-r[e].y);o.ctx.closePath()}}),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore())}},{key:"drawText",value:function(t,e,n,i){var r=1<arguments.length&&void 0!==e?e:0,o=2<arguments.length&&void 0!==n?n:0,s=3<arguments.length&&void 0!==i?i:{style:{},fill:!0},h=this.height;this.ctx.save(),s.textBaseline&&(this.ctx.textBaseline=s.textBaseline),this.ctx.font=s.font,s.fill?this.ctx.fillText(t,r,h-o):this.ctx.strokeText(t,r,h-o),this.ctx.restore()}}]),i}();var q=function(){function n(t,e){o(this,n),this._coord=t,this._incidentEdge=e}return h(n,[{key:"incidentEdge",set:function(t){this._incidentEdge=t},get:function(){return this._incidentEdge}},{key:"coord",set:function(t){this._coord=t},get:function(){return this._coord}},{key:"incidentFaces",get:function(){for(var t=this._incidentEdge,e=t.twin.next,n=[t.incidentFace];e!==t;)n.push(e.incidentFace),e=e.twin.next;return n.filter(function(t){return!!t})}}]),n}(),N=function(){function e(t){if(o(this,e),!(t&&t instanceof q))throw new Error("Origin must is vertex");this._origin=t}return h(e,[{key:"origin",set:function(t){this._origin=t},get:function(){return this._origin}},{key:"end",get:function(){return this.twin.origin}},{key:"direction",set:function(t){this._direction=t},get:function(){return this._direction}},{key:"twin",set:function(t){if(!(t&&t instanceof e))throw new Error("Twin must be halfEdge");this._twin=t},get:function(){return this._twin}},{key:"incidentFace",set:function(t){this._incidentFace=t},get:function(){return this._incidentFace}},{key:"next",set:function(t){if(!(t&&t instanceof e))throw new Error("Next must be halfEdge");this._next=t},get:function(){return this._next}},{key:"prev",set:function(t){if(!(t&&t instanceof e))throw new Error("Prev must be halfEdge");this._prev=t},get:function(){return this._prev}}]),e}(),J=function(){function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(o(this,i),t){if(!(t instanceof N))throw new Error("Face must has halfEdge outerComponent");t.incidentFace=this;for(var n=t.next;n&&n!==t;)n.incidentFace=this,n=n.next;this._outerComponent=t}if(!(e&&e instanceof Array))throw new Error("Face innnerComponents must is array");this._innerComponents=e}return h(i,[{key:"addInnerComponent",value:function(t){if(!(t&&t instanceof N))throw new Error("InnerComponent is HalfEdge");this._innerComponents.push(t)}},{key:"getVertices",value:function(){for(var t=this._outerComponent.next,e=[this._outerComponent.origin.coord];t&&t!==this._outerComponent;)e.push(t.origin.coord),t=t.next;return e}},{key:"getEdges",value:function(){for(var t=[this._outerComponent],e=this._outerComponent.next;e&&e!==this._outerComponent;)t.push(e),e=e.next;return t}},{key:"getAdjacentFaces",value:function(){for(var t=this._outerComponent.next,e=this._outerComponent.twin.incidentFace,n=e?[e]:[];t&&t!==this._outerComponent;)(e=t.twin.incidentFace)&&n.push(e),t=t.next;return n}},{key:"outerComponent",get:function(){return this._outerComponent},set:function(t){this._outerComponent=t}},{key:"innerComponents",get:function(){return this._innerComponents}},{key:"site",set:function(t){this._site=t},get:function(){return this._site}}]),i}(),B=function(){function e(t){o(this,e),this.faces=[],this.halfEdges=[],this.vertices=[]}return h(e,[{key:"removeVertex",value:function(e){var t=this.vertices.findIndex(function(t){return t===e});return-1!==t&&this.vertices.splice(t,1)}},{key:"insertVertex",value:function(){var t;(t=this.vertices).push.apply(t,arguments)}},{key:"removeHalfEdge",value:function(e){var t=this.halfEdges.findIndex(function(t){return t===e});return-1!==t&&this.halfEdges.splice(t,1)}},{key:"insertHalfEdge",value:function(){var t;(t=this.halfEdges).push.apply(t,arguments)}},{key:"removeFace",value:function(e){var t=this.faces.findIndex(function(t){return t===e});return-1!==t&&this.faces.splice(t,1)}},{key:"insertFace",value:function(){var t;(t=this.faces).push.apply(t,arguments)}}]),e}();function H(t,e,n){return t.prev=n,(t.next=e).prev=t,(e.next=n).prev=e,n.next=t,new J(t)}t.Animation=s,t.CanvasRender=F,t.Geometry=I,t.grahamScanCH=function(t,e){var n,i=[],r=E(t);for(i.push(r.shift()),i.push(r.shift());0<r.length;)b(i[(n=i.length)-2],i[n-1],r[0])?i.push(r.shift()):i.pop(),e&&Array.isArray(e)&&e.push({vertice:r[0],chVertices:i.map(function(t){return new C(t.x,t.y)})});return i},t.incremental3DCH=function(t){if(t&&!(t.length<4)){var e,n,i=new B;!function(t,e){var n=O(t,4),i=n[0],r=n[1],o=z(i,r,h=n[2],a=n[3]);if(o<0)var s=[a,h],h=s[0],a=s[1];else if(0===o)throw Error("Tetrahedron vertices on the same plane");var c=new q(i),u=new q(r),y=new q(h),l=new q(a),f=new N(c),g=new N(u),x=new N(u),d=new N(y),v=new N(y),p=new N(c),w=new N(c),b=new N(l),m=new N(u),k=new N(l),_=new N(y),E=new N(l);c.incidentEdge=f,u.incidentEdge=x,y.incidentEdge=v,l.incidentEdge=b,(f.twin=g).twin=f,(x.twin=d).twin=x,(v.twin=p).twin=v,(w.twin=b).twin=w,(m.twin=k).twin=m,(_.twin=E).twin=_;var P=H(f,x,v),C=H(g,w,k),T=H(d,m,E),S=H(p,_,b);e.insertVertex(c,u,y,l),e.insertHalfEdge(f,g,x,d,v,p,w,b,m,k,_,E),e.insertFace(P,C,T,S)}(t.slice(0,4),i);for(var r,o=4;o<t.length;o++){e=!1;for(var s=0;s<i.faces.length;s++)n=i.faces[s].getVertices(),z.apply(P,c(n).concat([t[o]]))<0&&(e=i.faces[s].delete=!0);e&&(i.faces.forEach(function(t){t.delete&&t.getEdges().forEach(function(t){t.delete=!0,t.origin.delete=!0})}),function(t,e){var n=e.halfEdges.find(function(t){return t.delete&&!t.twin.delete}),i=new q(t);e.insertVertex(i);var r,o,s,h=new N(n.origin),a=h,c=n;do{for(delete c.delete,delete c.origin.delete,s=c.next;s.twin.delete;)s=s.twin.next;c.origin.incidentEdge=c,((r=new N(i)).twin=a).twin=r,o=H(c,a=new N(c.end),r),e.insertFace(o),e.insertHalfEdge(r,a),c=s}while(c!==n);i.incidentEdge=r,a.twin=h.twin,h.twin.twin=a}(t[o],i),(r=i).vertices=r.vertices.filter(function(t){return!t.delete}),r.halfEdges=r.halfEdges.filter(function(t){return!t.delete}),r.faces=r.faces.filter(function(t){return!t.delete}))}return i}},t.incrementalCH=function(t,e){if(!(Array.isArray(t)&&e instanceof C))throw new TypeError("Paramters Type Error");if(t.length<2)t.push(e);else if(2===t.length)t.push(e),b.apply(P,c(t))||t.reverse();else{var n=[];t.unshift(t[t.length-1]),t.push(t[1]);for(var i=1;i<t.length-1;i++)b(t[i],t[i+1],e)?n.push(t[i]):b(t[i-1],t[i],e)&&(n.push(t[i]),n.push(e));t.splice.apply(t,[0,t.length].concat(n))}return t},t.upperLowerCH=function(t){for(var e,n,i=[],r=[],o=t.slice().sort(function(t,e){return t.x-e.x||t.x===e.x&&t.y-e.y}),s=o.length-1;0<=s;)(e=i.length)<2||b(i[e-2],i[e-1],o[s])?(i.push(o[s]),--s):i.pop();for(s=0;s<o.length;)(n=r.length)<2||b(r[n-2],r[n-1],o[s])?(r.push(o[s]),s+=1):r.pop();return r.shift(),r.pop(),i.concat(r)},Object.defineProperty(t,"__esModule",{value:!0})});
